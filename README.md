# üéÆ Game Master - Sistema de Control de Salas de Escape

Un sistema de gesti√≥n completo para salas de escape con temporizadores sincronizados, sistema de pistas multilenguaje y soporte para Chrome Cast.

## ‚ú® Caracter√≠sticas Principales

### üè† Gesti√≥n de Salas
- **5 salas independientes** con pesta√±as para control individual
- **Estado independiente** para cada sala sin interferencia entre ellas
- **Panel de control unificado** para gesti√≥n simult√°nea

### ‚è±Ô∏è Temporizador Sincronizado
- **Control en tiempo real**: Iniciar, pausar, reiniciar y modificar tiempo manualmente (+/-)
- **Sincronizaci√≥n autom√°tica** entre dispositivos usando WebSockets
- **Persistencia de estado**: El temporizador no se reinicia al actualizar la p√°gina
- **Indicadores visuales** seg√∫n el tiempo restante (normal, advertencia, cr√≠tico)

### üì∫ Vista Chrome Cast (Modo TV)
- **Bot√≥n dedicado** para abrir vista simplificada compatible con casting
- **Dise√±o optimizado** para pantallas grandes y visualizaci√≥n a distancia
- **Informaci√≥n en tiempo real**: temporizador, estado, pistas restantes y mensajes
- **Dise√±o responsive** que se adapta a diferentes resoluciones

### üí° Sistema de Pistas Avanzado
- **Indicadores visuales** de pistas restantes (3 por defecto, personalizable)
- **Biblioteca de pistas reutilizables** organizadas por categor√≠as:
  - General
  - Puzzles  
  - B√∫squeda
  - Final
  - Personalizada
- **Creaci√≥n de pistas en tiempo real** desde el frontend
- **Almacenamiento en base de datos** con versionado
- **Analytics de uso** para optimizar pistas
- **Gesti√≥n din√°mica**: Agregar pistas adicionales durante el juego

### üåê Soporte Multilenguaje
- **4 idiomas incluidos**: Espa√±ol, Ingl√©s, Franc√©s, Alem√°n
- **Pistas traducidas** autom√°ticamente seg√∫n idioma seleccionado
- **Interfaz multilenguaje** con cambio din√°mico
- **Mensajes localizados** para cada idioma

### üí¨ Sistema de Mensajes
- **Mensajes predefinidos** por idioma para comunicaci√≥n r√°pida
- **Mensajes personalizados** con editor de texto libre
- **Historial de mensajes** con timestamps y idioma utilizado
- **Visualizaci√≥n en tiempo real** en la vista TV

### üîÑ Funcionalidad de Reinicio
- **Reinicio inteligente**: Restablece temporizador, pistas y estado de sala
- **Preserva biblioteca**: No elimina pistas guardadas en la base de datos
- **Confirmaci√≥n de seguridad** para evitar reinicios accidentales

## üöÄ Instalaci√≥n y Configuraci√≥n

### Prerrequisitos
- **Node.js** (versi√≥n 18 o superior)
- **npm** (incluido con Node.js)

### Instalaci√≥n Local

1. **Clonar o descargar el proyecto**
   ```bash
   git clone <url-del-proyecto>
   cd gamemaster
   ```

2. **Instalar dependencias**
   ```bash
   npm install
   ```

3. **Configurar entorno de desarrollo**
   ```bash
   # Terminal 1: Iniciar servidor backend
   npm run dev:server
   # Terminal 2: Iniciar cliente frontend  
   npm run dev
   ```

4. **Acceder a la aplicaci√≥n**
   - **Panel de control**: http://localhost:5173
   - **Vista TV**: http://localhost:5173?tv=true&room=0
   - **API Backend**: http://localhost:3001

### Desarrollo Completo (Un Solo Comando)
```bash
npm run dev:full
```
Este comando ejecuta frontend y backend simult√°neamente.

## üì± Uso de la Aplicaci√≥n

### Panel Principal
1. **Seleccionar Sala**: Usar las pesta√±as superiores para cambiar entre salas
2. **Control de Tiempo**: 
   - ‚ñ∂Ô∏è Iniciar/Pausar temporizador
   - üîÑ Reiniciar a 60 minutos
   - ‚ûï‚ûñ Ajustar tiempo en incrementos de 1 o 5 minutos
   - ‚öôÔ∏è Establecer tiempo personalizado

### Env√≠o de Pistas
1. **Pistas Predefinidas**: Seleccionar de la biblioteca organizada por categor√≠as
2. **Pistas Personalizadas**: Escribir mensaje personalizado
3. **Gesti√≥n**: Agregar pistas adicionales durante el juego
4. **Idioma**: Cambiar idioma afecta las pistas mostradas

### Sistema de Mensajes
1. **Mensajes R√°pidos**: Botones predefinidos seg√∫n idioma
2. **Mensaje Personalizado**: Editor de texto libre
3. **Historial**: Ver mensajes enviados con timestamps

### Vista Chrome Cast
1. **Acceso**: Hacer clic en "üì∫ Vista TV" en el panel principal
2. **Casting**: Usar la funci√≥n de Chrome Cast del navegador
3. **Informaci√≥n Mostrada**:
   - Temporizador en grande con c√≥digo de colores
   - Estado de la sala (corriendo/pausado/terminado)
   - Indicadores de pistas restantes
   - √öltimo mensaje enviado
   - Estado de conexi√≥n

## üèóÔ∏è Arquitectura T√©cnica

### Frontend (Svelte + TypeScript)
- **Framework**: Svelte 5 con Vite
- **Estilo**: CSS moderno con variables y gradientes
- **Comunicaci√≥n**: Socket.IO client para tiempo real
- **Responsive**: Adaptable a m√≥viles y pantallas grandes

### Backend (Node.js + Express)
- **Servidor**: Express.js con Socket.IO
- **Base de Datos**: SQLite3 con esquema profesional
- **Sincronizaci√≥n**: WebSockets para tiempo real
- **API REST**: CRUD completo para salas y pistas
- **Analytics**: Tracking de uso de pistas y estad√≠sticas

### Base de Datos
- **SQLite** (`server/gamemaster.db`)
- **ACID compliance** para integridad de datos
- **Backup autom√°tico** y recuperaci√≥n
- **Schema profesional**:
  ```sql
  rooms: id, name, time_remaining, is_running, hints_remaining, last_message
  hints: id, text_es, text_en, text_fr, text_de, category, created_by
  hint_usage: room_id, hint_id, hint_text, language, sent_at (analytics)
  ```

## üåê Despliegue en Producci√≥n

### Opci√≥n 1: Servidor Tradicional

1. **Preparar para producci√≥n**
   ```bash
   npm run build
   ```

2. **Subir archivos**
   - Subir carpeta `dist/` al servidor web
   - Subir carpeta `server/` al servidor Node.js
   - Subir `package.json` y `package-lock.json`

3. **Configurar servidor**
   ```bash
   npm install --production
   npm run server
   ```

4. **Configurar reverse proxy** (Nginx/Apache)
   ```nginx
   location / {
     try_files $uri $uri/ /index.html;
   }
   
   location /socket.io/ {
     proxy_pass http://localhost:3001;
     proxy_http_version 1.1;
     proxy_set_header Upgrade $http_upgrade;
     proxy_set_header Connection "upgrade";
   }
   ```

### Opci√≥n 2: Plataformas Cloud

#### Vercel
```bash
# Instalar Vercel CLI
npm i -g vercel

# Desplegar
vercel
```

#### Railway/Render
1. Conectar repositorio GitHub
2. Configurar build command: `npm run build`
3. Configurar start command: `npm run server`

#### Heroku
```bash
# Procfile
web: npm run server

# Variables de entorno
NODE_ENV=production
PORT=$PORT
```

### Configuraci√≥n de Variables de Entorno
```bash
# .env
NODE_ENV=production
PORT=3001
```

## üîß Configuraci√≥n Avanzada

### Personalizar Salas
Editar `server/index.js` l√≠nea 22:
```javascript
const initialGameState = {
  rooms: Array.from({ length: 5 }, (_, i) => ({
    // Cambiar cantidad y configuraci√≥n de salas
  }))
}
```

### Agregar Idiomas
1. Actualizar `src/lib/types.ts`:
   ```typescript
   export type Language = 'es' | 'en' | 'fr' | 'de' | 'pt'
   ```

2. Agregar traducciones en `src/lib/HintSystem.svelte` y componentes

### Personalizar Pistas
Editar archivo `server/gamedata.json` una vez generado:
```json
{
  "hints": [
    {
      "id": "custom_1",
      "text": {
        "es": "Tu pista personalizada",
        "en": "Your custom hint"
      },
      "category": "Personalizada"
    }
  ]
}
```

## üéØ Casos de Uso

### Para Game Masters
- **Control total** de m√∫ltiples salas simult√°neamente
- **Comunicaci√≥n fluida** con equipos mediante pistas y mensajes
- **Monitoreo visual** del progreso en pantallas externas
- **Flexibilidad** para ajustar tiempo y dificultad en tiempo real

### Para Operadores de Escape Rooms
- **Gesti√≥n profesional** de m√∫ltiples salas de escape
- **Experiencia inmersiva** para los jugadores con vista TV
- **Comunicaci√≥n multilenguaje** para clientes internacionales
- **Datos persistentes** que no se pierden por fallos t√©cnicos

## üõ†Ô∏è Comandos Disponibles

```bash
# Desarrollo
npm run dev              # Solo frontend
npm run dev:server       # Solo backend  
npm run dev:full         # Frontend + Backend

# Producci√≥n
npm run build            # Construir para producci√≥n
npm run preview          # Vista previa de producci√≥n
npm run server           # Ejecutar servidor de producci√≥n

# Utilidades
npm run check            # Verificar tipos TypeScript
```

## üìã Estado de Desarrollo

### ‚úÖ Funcionalidades Completadas
- [x] Gesti√≥n de 5 salas independientes
- [x] Temporizadores sincronizados con WebSockets
- [x] Sistema de pistas con biblioteca reutilizable
- [x] Soporte multilenguaje (ES, EN, FR, DE)
- [x] Vista TV optimizada para Chrome Cast
- [x] Sistema de mensajes en tiempo real
- [x] Bot√≥n de reinicio inteligente
- [x] Persistencia de datos en archivo JSON
- [x] API REST para gesti√≥n de salas
- [x] Interfaz responsive
- [x] Documentaci√≥n completa

### üîÑ Mejoras Futuras Sugeridas
- [ ] Base de datos SQL para mayor escalabilidad
- [ ] Sistema de autenticaci√≥n para m√∫ltiples operadores
- [ ] Estad√≠sticas y analytics de uso
- [ ] Temas personalizables
- [ ] Notificaciones push
- [ ] Integraci√≥n con sistemas de booking

## üêõ Soluci√≥n de Problemas

### El temporizador no se sincroniza
- Verificar que el backend est√© ejecut√°ndose en puerto 3001
- Comprobar la consola del navegador para errores de Socket.IO
- Reiniciar ambos servidores

### La vista TV no se actualiza
- Verificar la URL de la vista TV incluye `?tv=true&room=X`
- Comprobar que el navegador soporta WebSockets
- Verificar conexi√≥n de red

### Faltan pistas o mensajes
- Comprobar el archivo `server/gamedata.json`
- Verificar permisos de escritura en el directorio del servidor
- Revisar logs del servidor para errores

### Error de conexi√≥n de base de datos
- Verificar que el directorio `server/` tiene permisos de escritura
- Comprobar espacio disponible en disco
- Revisar formato del archivo JSON

## üìû Soporte

Para problemas t√©cnicos o sugerencias, revisar:
1. **Logs del servidor**: `console.log` en terminal del backend
2. **Consola del navegador**: F12 ‚Üí Console para errores frontend
3. **Archivo de datos**: `server/gamedata.json` para estado persistente

## üìÑ Licencia

Este proyecto est√° desarrollado para uso en salas de escape. Libre para uso comercial y modificaci√≥n.

---

**üéÆ ¬°Disfruta gestionando tus salas de escape con Game Master!**